<!-- Filtres pour les résultats de recherche -->
<div class="mb-6 sm:mb-8">
    <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 mx-2 sm:mx-0">
        <form class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 gap-2 sm:gap-3"
              method="get"
              id="searchFiltersForm">
            
            <!-- Conserver les paramètres de recherche -->
            <input type="hidden" name="text" value="{{ text }}">
            <input type="hidden" name="keywords" value="{{ keywords }}">
            
            <!-- Filtres de prix -->
            <div class="space-y-1">
                <input type="number" name="price_min" placeholder="Prix min" 
                       value="{{ selected_price_min }}"
                       class="w-full text-sm rounded-lg border border-gray-200 px-2 py-1.5 text-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500 font-bitter">
            </div>
            <div class="space-y-1">
                <input type="number" name="price_max" placeholder="Prix max" 
                       value="{{ selected_price_max }}"
                       class="w-full text-sm rounded-lg border border-gray-200 px-2 py-1.5 text-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500 font-bitter">
            </div>

            <!-- Filtre de condition -->
            <div class="space-y-1">
                <select name="condition" class="w-full text-sm rounded-lg border border-gray-200 px-2 py-1.5 text-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500 font-bitter">
                    <option value="">État</option>
                    <option value="new" {% if selected_condition == 'new' %}selected{% endif %}>Neuf</option>
                    <option value="used" {% if selected_condition == 'used' %}selected{% endif %}>Occasion</option>
                    <option value="refurbished" {% if selected_condition == 'refurbished' %}selected{% endif %}>Reconditionné</option>
                </select>
            </div>

            <!-- Filtre de garantie -->
            <div class="space-y-1">
                <select name="warranty" class="w-full text-sm rounded-lg border border-gray-200 px-2 py-1.5 text-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500 font-bitter">
                    <option value="">Garantie</option>
                    <option value="yes" {% if selected_warranty == 'yes' %}selected{% endif %}>Avec garantie</option>
                    <option value="no" {% if selected_warranty == 'no' %}selected{% endif %}>Sans garantie</option>
                </select>
            </div>

            <!-- Filtre de promotion -->
            <div class="space-y-1">
                <select name="promotion" class="w-full text-sm rounded-lg border border-gray-200 px-2 py-1.5 text-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500 font-bitter">
                    <option value="">Promo</option>
                    <option value="yes" {% if selected_promotion == 'yes' %}selected{% endif %}>En promo</option>
                    <option value="no" {% if selected_promotion == 'no' %}selected{% endif %}>Sans promo</option>
                </select>
            </div>

            <!-- Boutons de soumission -->
            <div class="col-span-2 sm:col-span-4 md:col-span-6 flex flex-col sm:flex-row justify-end gap-2 sm:gap-3">
                <button type="submit" 
                        class="w-full sm:w-auto inline-flex items-center justify-center px-3 sm:px-4 py-2 sm:py-2.5 bg-green-600 text-white text-xs sm:text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-bitter">
                    <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
                    </svg>
                    <span class="whitespace-nowrap font-bitter">Filtrer</span>
                </button>
                <a href="/search/results/?text={{ text }}&keywords={{ keywords }}" 
                   class="w-full sm:w-auto inline-flex items-center justify-center px-3 sm:px-4 py-2 sm:py-2.5 bg-gray-100 text-gray-700 text-xs sm:text-sm font-medium rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md font-bitter">
                    <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                    <span class="whitespace-nowrap font-bitter">Reset</span>
                </a>
            </div>
        </form>
    </div>
</div>

<!-- Bouton Filtres mobile -->
<button class="fixed bottom-4 right-4 z-50 bg-green-600 text-white p-2.5 rounded-full shadow-lg md:hidden hover:bg-green-700 transition-colors duration-200"
        onclick="toggleSearchFilters()">
    <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
    </svg>
</button>

<!-- Panneau de filtres mobile (modal) -->
<div id="searchFiltersPanel" class="fixed inset-0 z-40 bg-black bg-opacity-40 flex items-end md:items-center justify-center transition-all duration-300 hidden">
    <div class="bg-white w-full md:w-80 rounded-t-2xl md:rounded-xl p-3 max-h-[80vh] overflow-y-auto shadow-xl">
        <div class="flex items-center justify-between mb-2">
            <h2 class="text-base font-bold text-gray-900 font-bitter">Filtres de recherche</h2>
            <button onclick="toggleSearchFilters()" class="text-gray-400 hover:text-gray-700 transition-colors duration-200">
                <span class="sr-only">Fermer</span>
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>

        <form method="get" class="space-y-1.5">
            <!-- Conserver les paramètres de recherche -->
            <input type="hidden" name="text" value="{{ text }}">
            <input type="hidden" name="keywords" value="{{ keywords }}">
            
            <!-- Prix -->
            <div class="bg-gray-50 rounded-lg p-2 sm:p-3">
                <button type="button" class="w-full px-2 sm:px-3 py-1 sm:py-1.5 flex items-center justify-between text-sm font-medium text-gray-900 font-bitter" onclick="toggleSection('searchPriceSection')">
                    <span class="flex-1 text-left">Prix</span>
                    <svg class="h-4 w-4 flex-shrink-0 ml-2 transform transition-transform duration-200" id="searchPriceSectionIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="searchPriceSection" class="mt-2 space-y-2 sm:space-y-3">
                    <div class="grid grid-cols-2 gap-2 sm:gap-3">
                        <div>
                            <label for="search_price_min" class="block text-xs sm:text-sm text-gray-600 mb-1 font-bitter">Min</label>
                            <input type="number" name="price_min" id="search_price_min" value="{{ selected_price_min }}" 
                                   class="w-full px-2 sm:px-3 py-1 sm:py-1.5 text-sm border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"
                                   placeholder="Min">
                        </div>
                        <div>
                            <label for="search_price_max" class="block text-xs sm:text-sm text-gray-600 mb-1 font-bitter">Max</label>
                            <input type="number" name="price_max" id="search_price_max" value="{{ selected_price_max }}" 
                                   class="w-full px-2 sm:px-3 py-1 sm:py-1.5 text-sm border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"
                                   placeholder="Max">
                        </div>
                    </div>
                </div>
            </div>

            <!-- État du produit -->
            <div class="bg-gray-50 rounded-lg p-2 sm:p-3">
                <button type="button" class="w-full px-2 sm:px-3 py-1 sm:py-1.5 flex items-center justify-between text-sm font-medium text-gray-900 font-bitter" onclick="toggleSection('searchConditionSection')">
                    <span class="flex-1 text-left">État</span>
                    <svg class="h-4 w-4 flex-shrink-0 ml-2 transform transition-transform duration-200" id="searchConditionSectionIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="searchConditionSection" class="mt-2 space-y-2 sm:space-y-3">
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="new" {% if selected_condition == 'new' %}checked{% endif %} class="mr-2 text-green-600 focus:ring-green-500">
                            <span class="text-sm text-gray-700">Neuf</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="used" {% if selected_condition == 'used' %}checked{% endif %} class="mr-2 text-green-600 focus:ring-green-500">
                            <span class="text-sm text-gray-700">Occasion</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="refurbished" {% if selected_condition == 'refurbished' %}checked{% endif %} class="mr-2 text-green-600 focus:ring-green-500">
                            <span class="text-sm text-gray-700">Reconditionné</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Boutons d'action -->
            <div class="flex gap-2 pt-2">
                <button type="submit" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors duration-200">
                    Appliquer
                </button>
                <a href="/search/results/?text={{ text }}&keywords={{ keywords }}" class="flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors duration-200 text-center">
                    Reset
                </a>
            </div>
        </form>
    </div>
</div>

<script>
function toggleSearchFilters() {
    const panel = document.getElementById('searchFiltersPanel');
    if (panel.classList.contains('hidden')) {
        panel.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    } else {
        panel.classList.add('hidden');
        document.body.style.overflow = '';
    }
}

function toggleSection(sectionId) {
    const section = document.getElementById(sectionId);
    const icon = document.getElementById(sectionId + 'Icon');
    
    if (section.style.display === 'none' || section.style.display === '') {
        section.style.display = 'block';
        icon.style.transform = 'rotate(180deg)';
    } else {
        section.style.display = 'none';
        icon.style.transform = 'rotate(0deg)';
    }
}

// Fermer le panneau en cliquant à l'extérieur
document.getElementById('searchFiltersPanel').addEventListener('click', function(e) {
    if (e.target === this) {
        toggleSearchFilters();
    }
});
</script> 