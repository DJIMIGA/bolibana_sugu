{% load static %}
{% load category_tags %}

<style>
@keyframes rotateArrow {
    from { transform: rotate(0deg); }
    to { transform: rotate(180deg); }
}

.arrow-rotate {
    animation: rotateArrow 0.3s ease-in-out forwards;
}

.arrow-rotate-reverse {
    animation: rotateArrow 0.3s ease-in-out reverse;
}
</style>

<!-- Menu déroulant principal -->
<div class="relative group">
    <button type="button" class="group flex items-center space-x-2 py-2 px-4 text-sm font-medium text-gray-800 hover:text-green-800 focus:outline-none border border-green-300 rounded-lg shadow-md transition-all duration-300">
        <!-- Icône menu -->
        <svg class="w-5 h-5 text-gray-600 group-hover:text-green-600 transition-colors duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
        <!-- Texte du bouton -->
        <span>Toutes les catégories</span>
        <!-- Flèche dynamique -->
        <svg id="arrow-icon" class="w-5 h-5 text-gray-600 group-hover:text-green-600 transition-colors duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
    </button>
    <!-- Menu déroulant multi-colonnes -->
    <div class="absolute left-0 w-[900px] bg-white rounded-md shadow-lg py-1 z-50 hidden group-hover:block">
        <div class="grid grid-cols-4">
            <!-- Première colonne - Catégories principales -->
            <div class="col-span-1 border-r border-gray-100">
                <div class="py-2">
                    {% for category in categories %}
                    <a href="{% url 'suppliers:category_detail' category.slug %}" 
                       class="block w-full px-4 py-2 text-sm text-gray-700 hover:bg-green-50 hover:text-green-700"
                       data-category="{{ category.id }}">
                        {{ category.name }}
                    </a>
                    {% endfor %}
                </div>
            </div>

            <!-- Deuxième section - Sous-catégories en colonnes -->
            <div class="col-span-3 border-r border-gray-100">
                <div class="py-2">
                    {% for category in categories %}
                    <!-- Sous-catégories pour {{ category.name }} -->
                    <div id="category-{{ category.id }}-sub" class="hidden">
                        <div class="flex flex-row flex-wrap">
                            {% for subcategory_data in categories_hierarchy|get_item:category.id|get_item:'subcategories'|get_values %}
                                <div class="w-1/3 min-w-[200px] border-r border-gray-100 last:border-r-0">
                                    <!-- Titre de la sous-catégorie -->
                                    <h3 class="px-4 py-2 text-sm font-medium text-gray-900 border-b border-gray-100">
                                        <a href="{% url 'suppliers:category_detail' subcategory_data.subcategory.slug %}" 
                                           class="block w-full -mx-4 px-4 py-2 hover:bg-green-50 hover:text-green-700">
                                            {{ subcategory_data.subcategory.name }}
                                        </a>
                                    </h3>
                                    <!-- Sous-sous-catégories -->
                                    <div class="px-4">
                                        {% for subsubcategory in subcategory_data.subsubcategories %}
                                            <a href="{% url 'suppliers:category_detail' subsubcategory.slug %}" 
                                               class="block w-full -mx-4 px-4 py-2 text-sm text-gray-700 hover:bg-green-50 hover:text-green-700 transition-colors duration-200">
                                                {{ subsubcategory.name }}
                                            </a>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'js/menu-category.js' %}"></script> 